package com.hx.bigdata

/**
  * Created by fangqing on 8/18/17.
  */
object Constant {
  val SOURCEDB = "sjww"
  val RESULTDB = "test12"
  val DBURL = "jdbc:mysql://10.10.60.196:3306/"
  val DBUSER = "zfw"
  val DBPASSWD = "123456"
  val REGION_TABLE = "taxi_region"
  val TAXIGPS_TABLE = s"taxigps"
  val RESULT_TABLE = "test_taxinumber"
  val DETAIL_RESULT_TABLE = "taxidetail"
  val APP_NAME = "car statistics"
  val CALCULATE_INTERVAL = 15
  val TIME_FORMATE = "yyyy-MM-dd HH:mm:ss"
  val TAXIGPS_TABLE_FEILDS = "id,carno,company,pos_time,pos_lat,pos_lon,getpos_lat,getpos_lon,stoppos_lat,stoppos_lon," +
    "pos_angle,use_area,pay_amount,name,idcard,sex,telephone,address,plate_time,bz"
  val RESULT_TABLE_FIELDS = "id,id_bh,compute_time,aggregated_quantity"
  val REGION_TABLE_FIELDS = "id,bh,region_type,regin,pos_lon,pos_lat"
  val DETAIL_RESULT_TABLE_FIELDS = "id,number_id,pos_lat,pos_lon,pos_time,carno"
  val REGION_FLAG = "region"


}

//update taxi_region set leixin='road' where leixin='路线';
//update taxi_region set leixin='region' where leixin='区域';

/*

+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| id          | varchar(200) | NO   | PRI | NULL    |       |
| carno       | varchar(20)  | YES  |     | NULL    |       |
| company     | varchar(50)  | YES  |     | NULL    |       |
| pos_time    | datetime     | YES  |     | NULL    |       |
| pos_lat     | varchar(50)  | YES  |     | NULL    |       |
| pos_lon     | varchar(50)  | YES  |     | NULL    |       |
| getpos_lat  | varchar(50)  | YES  |     | NULL    |       |
| getpos_lon  | varchar(50)  | YES  |     | NULL    |       |
| stoppos_lat | varchar(50)  | YES  |     | NULL    |       |
| stoppos_lon | varchar(50)  | YES  |     | NULL    |       |
| pos_angle   | varchar(50)  | YES  |     | NULL    |       |
| use_area    | varchar(100) | YES  |     | NULL    |       |
| pay_amount  | varchar(50)  | YES  |     | NULL    |       |
| name        | varchar(20)  | YES  |     | NULL    |       |
| idcard      | varchar(20)  | YES  |     | NULL    |       |
| sex         | varchar(4)   | YES  |     | NULL    |       |
| telephone   | varchar(50)  | YES  |     | NULL    |       |
| address     | varchar(100) | YES  |     | NULL    |       |
| plate_time  | datetime     | YES  |     | NULL    |       |
| bz          | varchar(50)  | YES  |     | NULL    |       |
+-------------+--------------+------+-----+---------+-------+

taxinumber
create table taxinumber(id int not null auto_increment primary key, compute_time timestamp,aggregated_quantity int)

create table taxinumber(id int not null auto_increment primary key, id_bh int,compute_time timestamp,aggregated_quantity int)
create table test_taxinumber(id int not null auto_increment primary key, id_bh int,compute_time timestamp,aggregated_quantity int)

taxidetail
create table taxidetail(id int not null auto_increment primary key, number_id int,pos_lat varchar(50),pos_lon varchar(50),pos_time timestamp,carno varchar(20))

 val REGION_TABLE_FIELDS = "id,bh,regin,pos_lon,pos_lat"

taxidetail
create table taxi_region(id int not null auto_increment primary key, bh int,regin varchar(50),pos_lon varchar(50),pos_lat varchar(50))



+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| id      | varchar(50) | NO   | PRI |         |       |
| bh      | varchar(20) | NO   |     | NULL    |       |
| regin   | varchar(50) | YES  |     | NULL    |       |
| pos_lon | double      | YES  |     | NULL    |       |
| pos_lat | double      | YES  |     | NULL    |       |
| leixin  | varchar(20) | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
26.57183,26.57123,106.704822,106.704222
=>in road 26.57183,26.57123,106.704822,106.704222
=>in road 26.571348999999998,26.570749,106.705064,106.704464
=>in road 26.570750999999998,26.570151,106.70568899999999,106.705089
=>in road 26.570513,26.569913,106.70610599999999,106.705506
=>in road 26.568247,26.567647,106.70991099999999,106.709311
=>in road 26.567201,26.566601000000002,106.71217399999999,106.711574
=>in road 26.565763,26.565163000000002,106.715552,106.71495200000001
=>in road 26.565633,26.565033,106.71673799999999,106.716138
=>in road 26.565714,26.565114,106.71811199999999,106.717512
=>in road 26.566226999999998,26.565627,106.72157999999999,106.72098
=>in road 26.566962,26.566362,106.72595899999999,106.725359
=>in road 26.567826999999998,26.567227,106.730594,106.729994
=>in road 26.568718999999998,26.568119,106.73447499999999,106.733875
=>in road 26.568856999999998,26.568257,106.73405699999999,106.733457
=>in road 26.56853,26.56793,106.73254399999999,106.731944
=>in road 26.567928,26.567328,106.729705,106.729105
=>in road 26.567249,26.566649,106.72591399999999,106.725314
=>in road 26.566502,26.565902,106.7214,106.72080000000001
=>in road 26.56605,26.565450000000002,106.71811199999999,106.717512
=>in road 26.565945,26.565345,106.716792,106.716192
=>in road 26.566041,26.565441,106.71561899999999,106.715019
=>in road 26.567479,26.566879,106.71239899999999,106.711799
=>in road 26.568675,26.568075,106.71001,106.70941
=>in road 26.56876,26.568160000000002,106.70961899999999,106.709019
=>in road 26.570723,26.570123000000002,106.70624099999999,106.705641
=>in road 26.570750999999998,26.570151,106.706093,106.705493
=>in road 26.571236,26.570636,106.705496,106.704896
=>in road 26.571493999999998,26.570894,106.70532899999999,106.704729
=>in road 26.57187,26.571270000000002,106.705159,106.704559
=>in road 26.570723,26.570123000000002,106.726462,106.725862
=>in road 26.570643,26.570043000000002,106.726579,106.72597900000001
=>in road 26.570118,26.569518000000002,106.727621,106.72702100000001
=>in road 26.569875,26.569275,106.728079,106.727479
=>in road 26.569754,26.569154,106.728331,106.727731
=>in road 26.569617,26.569017000000002,106.728546,106.727946
=>in road 26.569487,26.568887,106.729023,106.728423
=>in road 26.569754,26.569154,106.73159199999999,106.730992
=>in road 26.569689,26.569089,106.732113,106.731513
=>in road 26.569487,26.568887,106.73267899999999,106.732079
=>in road 26.569294,26.568694,106.73258899999999,106.731989
=>in road 26.569504,26.568904,106.732068,106.731468
=>in road 26.569536,26.568936,106.73160999999999,106.73101
=>in road 26.569294,26.568694,106.728996,106.728396
=>in road 26.56952,26.568920000000002,106.728358,106.72775800000001
=>in road 26.569924,26.569324,106.727522,106.726922
=>in road 26.570521,26.569921,106.726373,106.725773
=>in road 26.570546,26.569946,106.726292,106.72569200000001
=>in road 26.585235,26.584635000000002,106.719392,106.71879200000001
=>in road 26.584,26.5834,106.719338,106.718738
=>in road 26.583854,26.583254,106.71932,106.71872
=>in road 26.582981999999998,26.582382,106.719158,106.718558
=>in road 26.582432999999998,26.581833,106.718988,106.718388
=>in road 26.581932,26.581332,106.718907,106.71830700000001
=>in road 26.581955999999998,26.581356,106.71909,106.71849
=>in road 26.582421999999998,26.581822,106.719167,106.71856700000001
=>in road 26.582901,26.582301,106.71931099999999,106.718711
=>in road 26.583903,26.583303,106.719481,106.71888100000001
=>in road 26.585238999999998,26.584639,106.719544,106.71894400000001
=>in road 26.604250999999998,26.603651,106.71429599999999,106.713696
=>in road 26.604134,26.603534,106.714208,106.71360800000001
=>in road 26.60323,26.60263,106.71499899999999,106.714399
=>in road 26.601211,26.600611,106.716607,106.716007
=>in road 26.601058,26.600458,106.71664299999999,106.716043
=>in road 26.600428,26.599828000000002,106.716948,106.71634800000001
=>in road 26.598732,26.598132,106.71763999999999,106.71704
=>in road 26.598755999999998,26.598156,106.717891,106.717291
=>in road 26.600742999999998,26.600143,106.71710999999999,106.71651
=>in road 26.601066,26.600466,106.71692999999999,106.71633
=>in road 26.601356,26.600756,106.716724,106.71612400000001
=>in road 26.603189999999998,26.60259,106.715277,106.71467700000001
=>in road 26.651875999999998,26.651276,106.656537,106.65593700000001
=>in road 26.652183,26.651583000000002,106.650761,106.65016100000001
=>in road 26.645402,26.644802000000002,106.6505,106.6499
=>in road 26.645402,26.644802000000002,106.65405799999999,106.653458
=>in road 26.645394,26.644794,106.65407599999999,106.653476
=>in road 26.645402,26.644802000000002,106.655001,106.65440100000001
=>in road 26.645402,26.644802000000002,106.656097,106.65549700000001
=>in road 26.646442999999998,26.645843,106.65636599999999,106.655766
=>in road 26.647872,26.647272,106.65651899999999,106.655919
=>in road 26.577327999999998,26.576728,106.728105,106.72750500000001
=>in road 26.577707999999998,26.577108,106.727845,106.72724500000001
=>in road 26.578039,26.577439000000002,106.727368,106.726768
=>in road 26.578297,26.577697,106.726856,106.726256
=>in road 26.578596,26.577996000000002,106.724629,106.724029
=>in road 26.578386,26.577786,106.72444,106.72384000000001
=>in road 26.578111,26.577511,106.724009,106.723409
=>in road 26.577666999999998,26.577067,106.723416,106.72281600000001
=>in road 26.576988999999998,26.576389,106.723371,106.72277100000001
=>in road 26.575308,26.574708,106.72431399999999,106.723714
=>in road 26.575962999999998,26.575363,106.728482,106.72788200000001
=>in road 26.563878,26.563278,106.71061499999999,106.710015
=>in road 26.564775,26.564175000000002,106.711055,106.71045500000001
=>in road 26.565397,26.564797000000002,106.71130699999999,106.710707
=>in road 26.56551,26.56491,106.71145,106.71085000000001
=>in road 26.566793999999998,26.566194,106.71212399999999,106.711524
=>in road 26.567069,26.566469,106.712295,106.711695
=>in road 26.567125,26.566525000000002,106.71206099999999,106.711461
=>in road 26.566098999999998,26.565499,106.71154899999999,106.710949
=>in road 26.565526,26.564926,106.711298,106.71069800000001
=>in road 26.565397,26.564797000000002,106.71130699999999,106.710707
=>in road 26.577339,26.576739,106.73516699999999,106.734567
=>in road 26.577363,26.576763,106.734673,106.73407300000001
=>in road 26.577533,26.576933,106.733909,106.733309
=>in road 26.577573,26.576973000000002,106.733559,106.73295900000001
=>in road 26.577783,26.577183,106.732185,106.73158500000001
=>in road 26.577790999999998,26.577191,106.731466,106.730866
=>in road 26.577598,26.576998,106.730801,106.73020100000001
=>in road 26.577347,26.576747,106.729948,106.729348
=>in road 26.577315,26.576715,106.729445,106.728845
=>in road 26.577347,26.576747,106.728178,106.72757800000001
=>in road 26.577371,26.576771,106.735517,106.73491700000001
=>in road 26.577282999999998,26.576683,106.735535,106.73493500000001
=>in road 26.577194,26.576594,106.73514899999999,106.734549
=>in road 26.577234,26.576634000000002,106.73456499999999,106.733965
=>in road 26.577363,26.576763,106.733927,106.733327
=>in road 26.577645999999998,26.577046,106.73212199999999,106.731522
=>in road 26.577662,26.577062,106.73163699999999,106.731037
=>in road 26.577468,26.576868,106.730846,106.73024600000001
=>in road 26.577388,26.576788,106.730666,106.73006600000001
=>in road 26.577218,26.576618,106.729939,106.72933900000001
=>in road 26.577161,26.576561,106.72823199999999,106.727632
=>in road 26.588271,26.587671,106.69996599999999,106.699366
=>in road 26.588407999999998,26.587808,106.70221199999999,106.701612
=>in road 26.588582,26.587982,106.704503,106.70390300000001
=>in road 26.588586,26.587986,106.70643899999999,106.705839
=>in road 26.588606,26.588006,106.70714799999999,106.706548
=>in road 26.588534,26.587934,106.71017599999999,106.709576
=>in road 26.588639,26.588039000000002,106.71208899999999,106.711489
=>in road 26.58924,26.58864,106.71453699999999,106.713937
=>in road 26.589543,26.588943,106.715296,106.714696
=>in road 26.589966999999998,26.589367,106.717147,106.716547
=>in road 26.590169,26.589569,106.71799999999999,106.7174
=>in road 26.590642,26.590042,106.71936099999999,106.718761
=>in road 26.591251,26.590651,106.721387,106.720787
=>in road 26.59214,26.591540000000002,106.72431499999999,106.723715
=>in road 26.592741999999998,26.592142,106.726143,106.725543
=>in road 26.592524,26.591924000000002,106.726484,106.72588400000001
=>in road 26.591918,26.591318,106.724409,106.723809
=>in road 26.591041,26.590441000000002,106.72147199999999,106.720872
=>in road 26.59048,26.58988,106.719428,106.718828
=>in road 26.589862,26.589262,106.71731299999999,106.716713
=>in road 26.589761,26.589161,106.71712,106.71652
=>in road 26.589349,26.588749,106.715283,106.71468300000001
=>in road 26.588744,26.588144,106.71328799999999,106.712688
=>in road 26.588425,26.587825000000002,106.712125,106.71152500000001
=>in road 26.588335999999998,26.587736,106.710122,106.709522
=>in road 26.588348,26.587748,106.70715299999999,106.706553
=>in road 26.588271,26.587671,106.706407,106.70580700000001
=>in road 26.588267,26.587667,106.70459699999999,106.703997
=>in road 26.588162,26.587562000000002,106.702563,106.701963
=>in road 26.588178,26.587578,106.702289,106.701689
=>in road 26.588033,26.587433,106.69976,106.69916
=>in road 26.573846,26.573246,106.717649,106.717049
=>in road 26.576795,26.576195000000002,106.720002,106.719402
=>in road 26.577724,26.577124,106.71878099999999,106.718181
=>in road 26.575155,26.574555,106.714891,106.714291
=>in road 26.58359,26.582990000000002,106.71674999999999,106.71615
=>in road 26.583612,26.583012,106.717137,106.716537
=>in road 26.583709,26.583109,106.71759499999999,106.716995
=>in road 26.583938,26.583338,106.71808,106.71748000000001
=>in road 26.584032,26.583432000000002,106.718628,106.718028
=>in road 26.584016,26.583416,106.718915,106.718315
=>in road 26.583486999999998,26.582887,106.720874,106.720274
=>in road 26.583579999999998,26.58298,106.721008,106.720408
=>in road 26.583976,26.583376,106.71955299999999,106.718953
=>in road 26.584149,26.583549,106.71895099999999,106.718351
=>in road 26.584176,26.583576,106.71864599999999,106.718046
=>in road 26.584063999999998,26.583464,106.718035,106.71743500000001
=>in road 26.58387,26.583270000000002,106.717541,106.716941
=>in road 26.5838,26.5832,106.717236,106.71663600000001
=>in road 26.583743,26.583143,106.716768,106.71616800000001
=>in road 26.651132999999998,26.650533,106.641571,106.64097100000001
=>in road 26.651132999999998,26.650533,106.630675,106.630075
=>in road 26.651053,26.650453000000002,106.630522,106.62992200000001
=>in road 26.650714,26.650114000000002,106.630262,106.62966200000001
=>in road 26.650503999999998,26.649904,106.630145,106.62954500000001
=>in road 26.648712,26.648112,106.63033399999999,106.629734
=>in road 26.647088999999998,26.646489,106.630603,106.630003
=>in road 26.647109,26.646509000000002,106.63037899999999,106.629779
=>in road 26.648756,26.648156,106.630163,106.629563
=>in road 26.650451,26.649851,106.629966,106.629366
=>in road 26.650641,26.650041,106.629812,106.62921200000001
=>in road 26.650838999999998,26.650239,106.629804,106.629204
=>in road 26.651436,26.650836,106.630325,106.62972500000001
=>in road 26.651415999999998,26.650816,106.630504,106.62990400000001
=>in road 26.651319,26.650719000000002,106.630684,106.63008400000001
=>in road 26.651295,26.650695000000002,106.641598,106.64099800000001





=>in region 106.704522,106.734175,26.57157,26.565333
=>in region 106.725992,106.732379,26.570423,26.568994
=>in region 106.718607,106.719244,26.584939,26.581632
=>in region 106.713908,106.717591,26.603951,26.598432
=>in region 106.6502,106.656237,26.651883,26.645094
=>in region 106.723071,106.728182,26.578296,26.575008
=>in region 106.710315,106.711995,26.566825,26.563578
=>in region 106.727878,106.735235,26.577491,26.576861
=>in region 106.69946,106.726184,26.592442,26.587733
=>in region 106.714591,106.719702,26.577424,26.573546
=>in region 106.71645,106.720708,26.583876,26.583187
=>in region 106.629504,106.641298,26.651136,26.646789
cardf.filter($"pos_lon" > a).filter($"pos_lon" < b).filter($"pos_lat" < c).filter($"pos_lat" > d)


val jdbcDF = spark.read
      .format("jdbc")
      .option("url", "jdbc:mysql://10.10.60.196:3306/test12")
      .option("dbtable", "taxigps")
      .option("user", "zfw")
      .option("password", "123456")
      .load()




 */